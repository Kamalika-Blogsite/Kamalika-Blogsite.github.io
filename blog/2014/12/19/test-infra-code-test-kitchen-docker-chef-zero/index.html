
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Testing Infra Code - Test-Kitchen, Docker, Chef - My Blog site</title>
  <meta name="author" content="Kamalika Majumder">

  
  <meta name="description" content="In one of my recent project we had figured out how important it is to test your infrastructure code.So here in this blog I am going to discuss in &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kamalika-blogsite.github.io/blog/2014/12/19/test-infra-code-test-kitchen-docker-chef-zero">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Blog site" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Blog site</a></h1>
  
    <h2>A blogging framework</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kamalika-blogsite.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Testing Infra Code - Test-Kitchen, Docker, Chef</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-12-19T15:18:50+05:30'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:18 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>In one of my recent project we had figured out how important it is to test your infrastructure code.So here in this blog I am going to discuss in detail about the good practices and technologies that we used to do TDD for infra code.</p>

<p>In this blog I will be using three techs - &ldquo;Test-kitchen, Docker and Chef&rdquo; to do the demo.
This post will cover my talk in <a href="https://rootconf.in/2014/conference#1045-testing-infrastructure-code-using-test-kitchen-doc">#Rootconf - 2014</a></p>

<p>The workflow and practices can be followed with other equivalent tools as well.</p>

<!-- more -->


<h4><em>So here are the topics that we are going to cover in this blog</em></h4>

<ul>
<li>Why TDD for infra code ?</li>
<li>What is test-kitchen ?</li>
<li>Provision instances on demand => kitchen-docker</li>
<li>Configure the instances => Chef-zero</li>
<li>How to test the infra code => Test-kitchen</li>
<li>A Quick Demo</li>
</ul>


<h4><em>What are we trying to solve here</em></h4>

<p>Lets discuss about the four problems and their solutions above that we see quite often in every project.</p>

<p><strong>1. Manual steps to setup server:</strong> Every server having hardcoded configurations e.g: Data directory , user config , etc.The result, well , setting up takes hours even though you are following the same steps everytime.In short every server becomes a &ldquo;work of art&rdquo;.As a result it takes months to finish your deployment.</p>

<p><strong>Solution:</strong> Model server configurations, parameterize everything, relationships with other servers, packages in code.This is called <strong><em>Configuration Management</em></strong>.In our demo we are doing to use Chef as the Configuration Management tool to explain how it is done.</p>

<p><strong>2. No track of what changes were made when:</strong> Another very common issue that we see often is loosing track of what changed.Ever have been in a situation when you come to work one morning and your app server stops working , and you have no idea what changed or who changed.And then you spend one full day to finally find that the iptables rules have changed .</p>

<p><strong>Solution:</strong> We can solve the above issue if we follow step 1 and verion control that code . We will discuss more about <strong><em>Infra As Code</em></strong> in the blog.</p>

<p><strong>3. Code works in local host , not in Production:</strong> A classic developer quote ;) Ever wonder why is that so.Well the answer is pretty simple , inconsistency between dev, QA and Prod environment.If we want the same code on a developer laptop to go and build an app that will be deployed in production, then why dont we have same environment in dev as in production.</p>

<p><strong>Solution:</strong> Host a production like environment right at your dev laptop and the same in QA.So all devs and QAs have a prod like environment to test the same code that will eventually go in production.This way more bugs are caught before it goes to production.We will see how we can achieve that using <strong><em>Test-kitchen</em></strong> more coming forward.</p>

<p><strong>4. Testing takes forever:</strong> Well last but not the least , testing the infra code takes longer than ever.Reason can be not having environment to test the Infra-code.</p>

<p><strong>Solution:</strong> Scalable <strong><em>Environment On Demand</em></strong>. Have an environment that can be brought up , tested with the infra code and destroyed and recreated on demand in a timeline of 5 minutes - Now how does that sound ;)</p>

<p>Well all of the above and more can be done that will cut down you release cycle from months to weeks to days to minutes.In our project where we had followed all of the above our release cycle was cut down from twice a week to mutiple time in a day and the deployment time was brought down from 2 hours to 10 minutes.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Kamalika Majumder</span></span>

      




<time class='entry-date' datetime='2014-12-19T15:18:50+05:30'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:18 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://kamalika-blogsite.github.io/blog/2014/12/19/test-infra-code-test-kitchen-docker-chef-zero/" data-via="mjkamalika" data-counturl="http://kamalika-blogsite.github.io/blog/2014/12/19/test-infra-code-test-kitchen-docker-chef-zero/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/12/18/environment-on-demand/" title="Previous Post: Environment On Demand">&laquo; Environment On Demand</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/12/19/test-infra-code-test-kitchen-docker-chef-zero/">Testing Infra Code - Test-Kitchen, Docker, Chef</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/18/environment-on-demand/">Environment on Demand</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/18/from-sysadmin-to-devops/">From Sysadmin to Devops</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Kamalika Majumder -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
